{"ast":null,"code":"import _regeneratorRuntime from \"/Users/angelinewang/SEI/Token-Based-Authenication-React-Express/token-based-auth/student/react-mastermind/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/angelinewang/SEI/Token-Based-Authenication-React-Express/token-based-auth/student/react-mastermind/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/Users/angelinewang/SEI/Token-Based-Authenication-React-Express/token-based-auth/student/react-mastermind/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/angelinewang/SEI/Token-Based-Authenication-React-Express/token-based-auth/student/react-mastermind/src/pages/App/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport { Route, Switch } from 'react-router-dom';\nimport GamePage from '../../pages/GamePage/GamePage';\nimport SettingsPage from '../SettingsPage/SettingsPage';\nimport HighScoresPage from '../HighScoresPage/HighScoresPage';\nimport SignupPage from '../SignupPage/SignupPage';\nimport LoginPage from '../LoginPage/LoginPage';\nimport scoresService from '../../utils/scoresService';\nimport userService from '../../utils/userService';\nconst colors = {\n  Easy: ['#7CCCE5', '#FDE47F', '#E04644', '#B576AD'],\n  Moderate: ['#7CCCE5', '#FDE47F', '#E04644', '#B576AD', '#B7D968'],\n  Difficult: ['#7CCCE5', '#FDE47F', '#E04644', '#B576AD', '#B7D968', '#555E7B']\n};\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.isHighScore = guessesCopy => {\n      let lastScore = this.state.scores[this.state.scores.length - 1];\n      return guessesCopy.length < lastScore.numGuesses || guessesCopy.length === lastScore.numGuesses && this.state.elapsedTime < lastScore.seconds;\n    };\n\n    this.handleTimerUpdate = () => {\n      this.setState(curState => ({\n        elapsedTime: ++curState.elapsedTime\n      }));\n    };\n\n    this.handleDifficultyChange = level => {\n      // Use callback to ensure level is updated BEFORE calling handleNewGameClick\n      this.setState({\n        difficulty: level\n      }, () => this.handleNewGameClick());\n    };\n\n    this.handleColorSelection = colorIdx => {\n      this.setState({\n        selColorIdx: colorIdx\n      });\n    };\n\n    this.handleNewGameClick = () => {\n      this.setState(this.getInitialState());\n    };\n\n    this.handlePegClick = pegIdx => {\n      // Get index of last guess object\n      let currentGuessIdx = this.state.guesses.length - 1; // Always replace objects/arrays with NEW ones\n\n      let guessesCopy = [...this.state.guesses];\n\n      let guessCopy = _objectSpread({}, guessesCopy[currentGuessIdx]);\n\n      let codeCopy = [...guessCopy.code]; // Update the NEW code array with the currently selected color\n\n      codeCopy[pegIdx] = this.state.selColorIdx; // Update the NEW guess object\n\n      guessCopy.code = codeCopy; // Update the NEW guesses array\n\n      guessesCopy[currentGuessIdx] = guessCopy; // Update state with the NEW guesses array\n\n      this.setState({\n        guesses: guessesCopy\n      });\n    };\n\n    this.handleScoreClick = () => {\n      // Need the index of the current guess object (last object in guesses array)\n      let currentGuessIdx = this.state.guesses.length - 1; // Create \"working\" copies of the \"guessed\" code and the secret\n      // code so that we can modify them as we compute the number of\n      // perfect and almost without messing up the actual ones in state\n\n      let guessCodeCopy = [...this.state.guesses[currentGuessIdx].code];\n      let secretCodeCopy = [...this.state.code];\n      let perfect = 0,\n          almost = 0; // First pass computes number of \"perfect\"\n\n      guessCodeCopy.forEach((code, idx) => {\n        if (secretCodeCopy[idx] === code) {\n          perfect++; // Ensure same choice is not matched again\n          // by updating both elements in the \"working\"\n          // arrays to null\n\n          guessCodeCopy[idx] = secretCodeCopy[idx] = null;\n        }\n      }); // Second pass computes number of \"almost\"\n\n      guessCodeCopy.forEach((code, idx) => {\n        if (code === null) return;\n        let foundIdx = secretCodeCopy.indexOf(code);\n\n        if (foundIdx > -1) {\n          almost++; // Again, ensure same choice is not matched again\n\n          secretCodeCopy[foundIdx] = null;\n        }\n      }); // State must only be updated with NEW objects/arrays\n      // Always replace objects/arrays with NEW ones\n\n      let guessesCopy = [...this.state.guesses];\n\n      let guessCopy = _objectSpread({}, guessesCopy[currentGuessIdx]);\n\n      let scoreCopy = _objectSpread({}, guessCopy.score);\n\n      scoreCopy.perfect = perfect;\n      scoreCopy.almost = almost;\n      guessCopy.score = scoreCopy;\n      guessesCopy[currentGuessIdx] = guessCopy;\n\n      if (perfect === 4) {\n        // Chicken dinner - need to stop the timer!\n        this.setState(state => ({\n          isTiming: false\n        }), /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var initials;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                if (!(this.state.scores.length < 20 || this.isHighScore(guessesCopy))) {\n                  _context.next = 5;\n                  break;\n                }\n\n                initials = prompt('Congrats you have a top-20 score! Enter your initials: ').substr(0, 3);\n                _context.next = 4;\n                return scoresService.create({\n                  initials,\n                  numGuesses: guessesCopy.length,\n                  seconds: this.state.elapsedTime\n                });\n\n              case 4:\n                this.props.history.push('/high-scores');\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, this);\n        })));\n      } else {\n        guessesCopy.push(this.getNewGuess());\n      }\n\n      this.setState({\n        guesses: guessesCopy,\n        // This is a great way to update isTiming\n        isTiming: perfect !== 4\n      });\n    };\n\n    this.handleUpdateScores = scores => {\n      this.setState({\n        scores\n      });\n    };\n\n    this.state = _objectSpread(_objectSpread({}, this.getInitialState()), {}, {\n      difficulty: 'Easy',\n      scores: [],\n      user: userService.getUser()\n    });\n  }\n\n  getInitialState() {\n    return {\n      selColorIdx: 0,\n      guesses: [this.getNewGuess()],\n      code: this.genCode(),\n      elapsedTime: 0,\n      isTiming: true\n    };\n  }\n\n  getNewGuess() {\n    return {\n      code: [null, null, null, null],\n      score: {\n        perfect: 0,\n        almost: 0\n      }\n    };\n  }\n\n  genCode() {\n    let numColors = this.state && colors[this.state.difficulty].length;\n    numColors = numColors || 4;\n    return new Array(4).fill().map(dummy => Math.floor(Math.random() * numColors));\n  }\n\n  getWinTries() {\n    // if winner, return num guesses, otherwise 0 (no winner)\n    let lastGuess = this.state.guesses.length - 1;\n    return this.state.guesses[lastGuess].score.perfect === 4 ? lastGuess + 1 : 0;\n  }\n\n  /*--- Lifecycle Methods ---*/\n  componentDidMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var scores;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return scoresService.index();\n\n          case 2:\n            scores = _context2.sent;\n\n            _this.setState({\n              scores\n            });\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }))();\n  }\n\n  render() {\n    let winTries = this.getWinTries();\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      className: \"header-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }\n    }, \"R E A C T \\xA0\\xA0\\xA0  M A S T E R M I N D\"), /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => /*#__PURE__*/React.createElement(GamePage, {\n        winTries: winTries,\n        colors: colors[this.state.difficulty],\n        selColorIdx: this.state.selColorIdx,\n        guesses: this.state.guesses,\n        elapsedTime: this.state.elapsedTime,\n        isTiming: this.state.isTiming,\n        handleColorSelection: this.handleColorSelection,\n        handleNewGameClick: this.handleNewGameClick,\n        handlePegClick: this.handlePegClick,\n        handleScoreClick: this.handleScoreClick,\n        handleTimerUpdate: this.handleTimerUpdate,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/settings\",\n      render: props => /*#__PURE__*/React.createElement(SettingsPage, Object.assign({}, props, {\n        colorsLookup: colors,\n        difficulty: this.state.difficulty,\n        handleDifficultyChange: this.handleDifficultyChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 13\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/signup\",\n      render: ({\n        history\n      }) => /*#__PURE__*/React.createElement(SignupPage, {\n        history: history,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 13\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/login\",\n      render: () => /*#__PURE__*/React.createElement(LoginPage, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 13\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/high-scores\",\n      render: () => /*#__PURE__*/React.createElement(HighScoresPage, {\n        scores: this.state.scores,\n        handleUpdateScores: this.handleUpdateScores,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/angelinewang/SEI/Token-Based-Authenication-React-Express/token-based-auth/student/react-mastermind/src/pages/App/App.js"],"names":["React","Component","Route","Switch","GamePage","SettingsPage","HighScoresPage","SignupPage","LoginPage","scoresService","userService","colors","Easy","Moderate","Difficult","App","constructor","isHighScore","guessesCopy","lastScore","state","scores","length","numGuesses","elapsedTime","seconds","handleTimerUpdate","setState","curState","handleDifficultyChange","level","difficulty","handleNewGameClick","handleColorSelection","colorIdx","selColorIdx","getInitialState","handlePegClick","pegIdx","currentGuessIdx","guesses","guessCopy","codeCopy","code","handleScoreClick","guessCodeCopy","secretCodeCopy","perfect","almost","forEach","idx","foundIdx","indexOf","scoreCopy","score","isTiming","initials","prompt","substr","create","props","history","push","getNewGuess","handleUpdateScores","user","getUser","genCode","numColors","Array","fill","map","dummy","Math","floor","random","getWinTries","lastGuess","componentDidMount","index","render","winTries"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport { Route, Switch } from 'react-router-dom';\nimport GamePage from '../../pages/GamePage/GamePage';\nimport SettingsPage from '../SettingsPage/SettingsPage';\nimport HighScoresPage from '../HighScoresPage/HighScoresPage';\nimport SignupPage from '../SignupPage/SignupPage';\nimport LoginPage from '../LoginPage/LoginPage';\nimport scoresService from '../../utils/scoresService';\nimport userService from '../../utils/userService'\n\nconst colors = {\n  Easy: ['#7CCCE5', '#FDE47F', '#E04644', '#B576AD'],\n  Moderate: ['#7CCCE5', '#FDE47F', '#E04644', '#B576AD', '#B7D968'],\n  Difficult: ['#7CCCE5', '#FDE47F', '#E04644', '#B576AD', '#B7D968', '#555E7B']\n};\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = {...this.getInitialState(), difficulty: 'Easy', scores: [],\n  user: userService.getUser()};\n  }\n\n  \n\n  getInitialState() {\n    return {\n      selColorIdx: 0,\n      guesses: [this.getNewGuess()],\n      code: this.genCode(),\n      elapsedTime: 0,\n      isTiming: true\n    };\n  }\n\n  getNewGuess() {\n    return {\n      code: [null, null, null, null],\n      score: {\n        perfect: 0,\n        almost: 0\n      }\n    };\n  }\n\n  genCode() {\n    let numColors = this.state && colors[this.state.difficulty].length;\n    numColors = numColors || 4;\n    return new Array(4).fill().map(dummy => Math.floor(Math.random() * numColors));\n  }\n\n  getWinTries() {\n    // if winner, return num guesses, otherwise 0 (no winner)\n    let lastGuess = this.state.guesses.length - 1;\n    return this.state.guesses[lastGuess].score.perfect === 4 ? lastGuess + 1 : 0;\n  }\n\n  isHighScore = (guessesCopy) => {\n    let lastScore = this.state.scores[this.state.scores.length - 1];\n    return (guessesCopy.length < lastScore.numGuesses || (\n      guessesCopy.length === lastScore.numGuesses &&\n      this.state.elapsedTime < lastScore.seconds\n    ));\n  }\n\n  /*--- Callback Methods ---*/\n\n  handleTimerUpdate = () => {\n    this.setState((curState) => ({elapsedTime: ++curState.elapsedTime}));\n  }\n\n  handleDifficultyChange = (level) => {\n    // Use callback to ensure level is updated BEFORE calling handleNewGameClick\n    this.setState({difficulty: level}, () => this.handleNewGameClick());\n  }\n  \n  handleColorSelection = (colorIdx) => {\n    this.setState({selColorIdx: colorIdx});\n  }\n\n  handleNewGameClick = () => {\n    this.setState(this.getInitialState());\n  }\n\n  handlePegClick = (pegIdx) => {\n    // Get index of last guess object\n    let currentGuessIdx = this.state.guesses.length - 1;\n\n    // Always replace objects/arrays with NEW ones\n    let guessesCopy = [...this.state.guesses];\n    let guessCopy = {...guessesCopy[currentGuessIdx]};\n    let codeCopy = [...guessCopy.code];\n\n    // Update the NEW code array with the currently selected color\n    codeCopy[pegIdx] = this.state.selColorIdx;\n\n    // Update the NEW guess object\n    guessCopy.code = codeCopy;\n\n    // Update the NEW guesses array\n    guessesCopy[currentGuessIdx] = guessCopy;\n\n    // Update state with the NEW guesses array\n    this.setState({\n        guesses: guessesCopy\n    });\n  }\n\n  handleScoreClick = () => {\n    // Need the index of the current guess object (last object in guesses array)\n    let currentGuessIdx = this.state.guesses.length - 1;\n\n    // Create \"working\" copies of the \"guessed\" code and the secret\n    // code so that we can modify them as we compute the number of\n    // perfect and almost without messing up the actual ones in state\n    let guessCodeCopy = [...this.state.guesses[currentGuessIdx].code];\n    let secretCodeCopy = [...this.state.code];\n\n    let perfect = 0, almost = 0;\n\n    // First pass computes number of \"perfect\"\n    guessCodeCopy.forEach((code, idx) => {\n      if (secretCodeCopy[idx] === code) {\n        perfect++;\n        // Ensure same choice is not matched again\n        // by updating both elements in the \"working\"\n        // arrays to null\n        guessCodeCopy[idx] = secretCodeCopy[idx] = null;\n      }\n    });\n\n    // Second pass computes number of \"almost\"\n    guessCodeCopy.forEach((code, idx) => {\n      if (code === null) return;\n      let foundIdx = secretCodeCopy.indexOf(code);\n      if (foundIdx > -1) {\n        almost++;\n        // Again, ensure same choice is not matched again\n        secretCodeCopy[foundIdx] = null;\n      }\n    });\n\n    // State must only be updated with NEW objects/arrays\n        // Always replace objects/arrays with NEW ones\n    let guessesCopy = [...this.state.guesses];\n    let guessCopy = {...guessesCopy[currentGuessIdx]};\n    let scoreCopy = {...guessCopy.score};\n\n    scoreCopy.perfect = perfect;\n    scoreCopy.almost = almost;\n    guessCopy.score = scoreCopy;\n    guessesCopy[currentGuessIdx] = guessCopy;\n\n    if (perfect === 4) {\n      // Chicken dinner - need to stop the timer!\n      this.setState(state => ({isTiming: false}), async function() {\n        // Do high-score logic in this callback\n        if ((this.state.scores.length < 20 || this.isHighScore(guessesCopy))) {\n          let initials = prompt('Congrats you have a top-20 score! Enter your initials: ').substr(0, 3);\n          await scoresService.create({ initials, numGuesses: guessesCopy.length, seconds: this.state.elapsedTime });\n          this.props.history.push('/high-scores');\n        }        \n      });\n    } else {\n      guessesCopy.push(this.getNewGuess());\n    }\n\n    this.setState({\n      guesses: guessesCopy,\n      // This is a great way to update isTiming\n      isTiming: perfect !== 4\n    });\n  }\n\n  handleUpdateScores = (scores) => {\n    this.setState({ scores });\n  }\n\n  /*--- Lifecycle Methods ---*/\n\n  async componentDidMount() {\n    const scores = await scoresService.index();\n    this.setState({ scores });\n  }\n\n  render() {\n    let winTries = this.getWinTries();\n    return (\n      <div>\n        <header className='header-footer'>R E A C T &nbsp;&nbsp;&nbsp;  M A S T E R M I N D</header>\n        <Switch>\n          <Route exact path='/' render={() =>\n            <GamePage\n              winTries={winTries}\n              colors={colors[this.state.difficulty]}\n              selColorIdx={this.state.selColorIdx}\n              guesses={this.state.guesses}\n              elapsedTime={this.state.elapsedTime}\n              isTiming={this.state.isTiming}\n              handleColorSelection={this.handleColorSelection}\n              handleNewGameClick={this.handleNewGameClick}\n              handlePegClick={this.handlePegClick}\n              handleScoreClick={this.handleScoreClick}\n              handleTimerUpdate={this.handleTimerUpdate}\n            />\n          }/>\n          <Route exact path='/settings' render={props => \n            <SettingsPage\n              {...props} \n              colorsLookup={colors}\n              difficulty={this.state.difficulty}\n              handleDifficultyChange={this.handleDifficultyChange}\n            />\n          }/>\n          <Route exact path='/signup' render={({ history }) => \n            <SignupPage\n              history={history}\n              \n            />\n          }/>\n          <Route exact path='/login' render={() => \n            <LoginPage\n              \n            />\n          }/>\n          <Route exact path='/high-scores' render={() => \n            <HighScoresPage\n              scores={this.state.scores}\n              handleUpdateScores={this.handleUpdateScores}\n            />\n          }/>\n        </Switch>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}